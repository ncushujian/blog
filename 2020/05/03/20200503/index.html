<!DOCTYPE html>
<html lang="zh-CN">





<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/blog/img/favicon.png">
  <link rel="icon" type="image/png" href="/blog/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="shujian">
  <meta name="keywords" content="">
  <title>PWA使用调研 - ncushujian</title>

  <link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/blog/lib/hint/hint.min.css" />

  
    <link  rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.0.0/styles/github-gist.min.css" />
  

  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_yg9cfy8wd6.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_pjno9b9zyxs.css">


<link  rel="stylesheet" href="/blog/css/main.css" />

<!-- 自定义样式保持在最底部 -->

  
<link rel="stylesheet" href="/blog/custom/css/index.css">



  <script  src="/blog/js/utils.js" ></script>
<meta name="generator" content="Hexo 4.2.1"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/blog/">&nbsp;<strong>ncushujian's space</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/blog/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/blog/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/blog/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/blog/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/blog/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="view intro-2" id="background" parallax=true
         style="background: url('/blog/img/default.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="container text-center white-text fadeInUp">
            <span class="h2" id="subtitle">
              
                PWA使用调研
              
            </span>

            
              
  <div class="mt-3 post-meta">
    <i class="iconfont icon-date-fill" aria-hidden="true"></i>
    <time datetime="2020-05-03 00:00">
      2020年5月3日 凌晨
    </time>
  </div>


<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      1.8k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      22
       分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <div class="post-content mx-auto" id="post">
            
            <article class="markdown-body">
              <h2 id="1-介绍"><a href="#1-介绍" class="headerlink" title="1.介绍"></a>1.介绍</h2><p>​        PWA应用是指那些使用指定技术和标准模式来开发的web应用，这将同时赋予它们web应用和原生应用的特性。例如：</p>
<ul>
<li><p><a href="https://developer.mozilla.org/en-US/Apps/Progressive/Advantages#Discoverable" target="_blank" rel="noopener">Discoverable</a>, 内容可以通过搜索引擎发现。</p>
</li>
<li><p><a href="https://developer.mozilla.org/en-US/Apps/Progressive/Advantages#Installable" target="_blank" rel="noopener">Installable</a>, 可以出现在设备的主屏幕。</p>
</li>
<li><p><a href="https://developer.mozilla.org/Apps/Progressive/Advantages#Linkable" target="_blank" rel="noopener">Linkable</a>, 你可以简单地通过一个URL来分享它。 </p>
</li>
<li><p><a href="https://developer.mozilla.org/en-US/Apps/Progressive/Advantages#Network_independent" target="_blank" rel="noopener">Network independent</a>, 它可以在离线状态或者是在网速很差的情况下运行。</p>
</li>
<li><p><a href="https://developer.mozilla.org/en-US/Apps/Progressive/Advantages#Progressive" target="_blank" rel="noopener">Progressive</a>, 它在老版本的浏览器仍旧可以使用，在新版本的浏览器上可以使用全部功能。</p>
</li>
<li><p><a href="https://developer.mozilla.org/en-US/Apps/Progressive/Advantages#Re-engageable" target="_blank" rel="noopener">Re-engageable</a>, 无论何时有新的内容它都可以发送通知。</p>
</li>
<li><p><a href="https://developer.mozilla.org/en-US/Apps/Progressive/Advantages#Responsive" target="_blank" rel="noopener">Responsive</a>, 它在任何具有屏幕和浏览器的设备上可以正常使用——包括手机，平板电脑，笔记本，电视，冰箱，等。</p>
</li>
<li><p><a href="https://developer.mozilla.org/en-US/Apps/Progressive/Advantages#Safe" target="_blank" rel="noopener">Safe</a>, 在你和应用之间的连接是安全的，可以阻止第三方访问你的敏感数据。</p>
</li>
</ul>
<h2 id="2-demo"><a href="#2-demo" class="headerlink" title="2. demo"></a>2. demo</h2><p>service worker能劫持所有的网络请求，安全原因必须要在https或者localhost下运行。以下是一个项目地址为 <a href="https://mdn.github.io/sw-test" target="_blank" rel="noopener">https://mdn.github.io/sw-test</a> 的例子，步骤如下：</p>
<h4 id="2-1-注册"><a href="#2-1-注册" class="headerlink" title="2.1 注册"></a>2.1 注册</h4><pre><code class="hljs scilab"><span class="hljs-keyword">if</span> (<span class="hljs-string">'serviceWorker'</span> in navigator) &#123;
  navigator.serviceWorker.register(<span class="hljs-string">'/sw-test/sw.js'</span>, &#123; scope: <span class="hljs-string">'/sw-test/'</span> &#125;)
  .<span class="hljs-keyword">then</span>(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(reg)</span> &#123;</span>
    <span class="hljs-comment">// registration worked</span>
    console.<span class="hljs-built_in">log</span>(<span class="hljs-string">'Registration succeeded. Scope is '</span> + reg.scope);
  &#125;)
  .<span class="hljs-keyword">catch</span>(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(error)</span> &#123;</span>
    <span class="hljs-comment">// registration failed</span>
    console.<span class="hljs-built_in">log</span>(<span class="hljs-string">'Registration failed with '</span> + <span class="hljs-built_in">error</span>);
  &#125;);
&#125;</code></pre>

<p>该段代码检测是否支持serviceWorker，支持的话注册/sw-test/sw.js（url 是相对于域名），scope选填，表示service worker影响范围（该范围不能比注册的地方大，在该例子中，最大就是/sw-test/。除非后端设置了Service-Worker-Allowed），默认是当前路径(<a href="https://mdn.github.io/sw-test" target="_blank" rel="noopener">https://mdn.github.io/sw-test</a>)</p>
<h4 id="2-2-安装"><a href="#2-2-安装" class="headerlink" title="2.2 安装"></a>2.2 安装</h4><p>Sw.js中完成具体逻辑，如下：</p>
<pre><code class="hljs stata">this.addEventListener('install', function(event) &#123;
  event.waitUntil(
    caches.<span class="hljs-keyword">open</span>('v1').then(function(cache) &#123;
      <span class="hljs-keyword">return</span> cache.addAll([
        '/<span class="hljs-keyword">sw</span>-<span class="hljs-keyword">test</span>/',
        '/<span class="hljs-keyword">sw</span>-<span class="hljs-keyword">test</span>/index.html',
        '/<span class="hljs-keyword">sw</span>-<span class="hljs-keyword">test</span>/style.css',
        '/<span class="hljs-keyword">sw</span>-<span class="hljs-keyword">test</span>/<span class="hljs-keyword">app</span>.js',
        '/<span class="hljs-keyword">sw</span>-<span class="hljs-keyword">test</span>/image-<span class="hljs-keyword">list</span>.js',
        '/<span class="hljs-keyword">sw</span>-<span class="hljs-keyword">test</span>/star-wars-logo.jpg',
        '/<span class="hljs-keyword">sw</span>-<span class="hljs-keyword">test</span>/gallery/',
        '/<span class="hljs-keyword">sw</span>-<span class="hljs-keyword">test</span>/gallery/bountyHunters.jpg',
        '/<span class="hljs-keyword">sw</span>-<span class="hljs-keyword">test</span>/gallery/myLittleVader.jpg',
        '/<span class="hljs-keyword">sw</span>-<span class="hljs-keyword">test</span>/gallery/snowTroopers.jpg'
      ]);
    &#125;)
  );
&#125;);</code></pre>

<ul>
<li>Event.waitUntil确保Service Worker 不会在 <code>waitUntil()</code> 里面的代码执行完毕之前安装完成。</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/CacheStorage/open" target="_blank" rel="noopener"><code>caches.open()</code></a> 方法来创建了一个叫做 <code>v1</code> 的新的缓存</li>
<li><code>addAll()</code>这个方法的参数是一个由一组相对于 origin 的 URL 组成的数组，这些 URL 就是你想缓存的资源的列表，他会马上去加载一次这些资源，并且缓存。</li>
</ul>
<p>当promise被reject的时候，安装失败，反之安装成功，service worker就会激活。</p>
<h4 id="2-3-劫持"><a href="#2-3-劫持" class="headerlink" title="2.3 劫持"></a>2.3 劫持</h4><p>每次任何被 service worker 控制的资源被请求到时，都会触发 <code>fetch</code> 事件，这些资源包括了指定的 scope 内的文档，和这些文档内引用的其他任何资源（比如 <code>index.html</code> 发起了一个跨域的请求来嵌入一个图片，这个也会通过 service worker 。）</p>
<pre><code class="hljs js"><span class="hljs-keyword">this</span>.addEventListener(<span class="hljs-string">'fetch'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>&#123;
  event.respondWith(
    caches.match(event.request)
  );
&#125;);</code></pre>

<p>以上例子只是简单的响应这些缓存中的 url  和网络请求匹配的资源。</p>
<h2 id="3-生命周期"><a href="#3-生命周期" class="headerlink" title="3. 生命周期"></a>3. 生命周期</h2><ul>
<li><p>Installing</p>
<p>安装sw，执行install钩子。可以进行一些资源缓存，数据初始化（indexedDB）</p>
</li>
<li><p>installed</p>
<p>已经安装完成，等待使用了旧版本的sw的页面关闭</p>
</li>
<li><p>activating</p>
<p>激活sw，执行active钩子</p>
</li>
<li><p>activate</p>
<p>激活成功之后才能开始管控页面，fetch这些钩子才开始有效</p>
</li>
<li><p>redundant</p>
<p>失败获取被其他sw取代</p>
</li>
</ul>
<h2 id="4-更新顺序"><a href="#4-更新顺序" class="headerlink" title="4. 更新顺序"></a>4. 更新顺序</h2><ol>
<li><p>页面上通过navigator.serviceWorker.register来获取和注册。</p>
</li>
<li><p>受 service worker 控制的页面打开后会尝试去安装 service worker。最先发送给 service worker 的事件是安装事件(在这个事件里可以开始进行填充 IndexDB和缓存站点资源)。这个流程同原生 APP 或者 Firefox OS APP 是一样的 — 让所有资源可离线访问。</p>
</li>
<li><p>当 <code>oninstall</code>事件的处理程序执行完毕后，可以认为 service worker 安装完成了。</p>
</li>
<li><p>下一步是激活。当 service worker 安装完成后，会接收到一个激活事件(activate event)。 <code>onactivate</code>主要用途是清理先前版本的service worker 脚本中使用的资源。</p>
</li>
<li><p>重新刷新页面，会检测sw.js有无变化。没变化，不会重新在浏览器注册一个新的service worker(install钩子不会执行)，还是用旧的；有变化，会重新注册一个sw。期间，install钩子会直接执行，但是activate和其他不会执行，所以一般在activate清空上个版本的service worker相关缓存，等待使用旧的sevice worker的页面都关闭后，再激活新的service worker（如果使用了skipWaiting函数即可直接跳过install阶段）。未激活的service worker谷歌显示如下：</p>
<p><img src="/blog/img/20200503/image-20200527163404854.png" srcset="/blog/img/loading.gif" alt="image-20200527163404854"></p>
<p>下次再打开页面的时候，同时触发install和activate钩子</p>
</li>
<li><p>Service Worker 现在可以控制页面了，但仅是在 <code>register()</code> 成功后的打开的页面。也就是说，页面起始于有或则没有 service worker ，且在页面的接下来生命周期内维持这个状态。所以，页面不得不重新加载以让 service worker 获得完全的控制。（在activate钩子里使用clients.claim可以立即接管页面）</p>
</li>
</ol>
<h2 id="5-注意事项"><a href="#5-注意事项" class="headerlink" title="5. 注意事项"></a>5. 注意事项</h2><h3 id="5-1-全局变量"><a href="#5-1-全局变量" class="headerlink" title="5.1 全局变量"></a>5.1 全局变量</h3><p>service worker运行在浏览器独立的线程，因此没有获取dom的权限。单个 service worker 可以控制很多页面。每个你的 scope 里的页面加载完的时候，安装在页面的 service worker 可以控制它。牢记你需要小心 service worker 脚本里的全局变量： 每个页面不会有自己独有的worker。</p>
<h3 id="5-2-部分对象不可用"><a href="#5-2-部分对象不可用" class="headerlink" title="5.2 部分对象不可用"></a>5.2 部分对象不可用</h3><p>如window、localStorage、XMLHttpRequest在sw的上下文里是undefined，不确定的api用之前先测试一下。</p>
<h3 id="5-3-域名"><a href="#5-3-域名" class="headerlink" title="5.3 域名"></a>5.3 域名</h3><p>只能在https和localhost里面使用service worker，本地测试的时候请使用localhost(127.0.0.1实测也行)，用其他ip都不行，’serviceWorker’ in navigator会返回false</p>
<h3 id="5-4-不要更改service-worker文件名"><a href="#5-4-不要更改service-worker文件名" class="headerlink" title="5.4 不要更改service worker文件名"></a>5.4 不要更改service worker文件名</h3><p>启用离线访问的情况下，首页（index.html）会被sw(service worker)缓存。如果sw文件名称修改了，因为首页被缓存了，注册的sw文件路径还是旧的，所以根本不会启用新的sw（找不到sw文件并不会删除或更新sw）。</p>
<h3 id="5-5-调试"><a href="#5-5-调试" class="headerlink" title="5.5 调试"></a>5.5 调试</h3><p>由于service worker独立存在，所以错误的service worker可能会导致页面不可访问等其他情况。可以先去application选项卡把service worker清除</p>
<p><img src="/blog/img/20200503/image-20200527151840562.png" srcset="/blog/img/loading.gif" alt="image-20200527151840562"></p>
<h2 id="6-各api兼容性"><a href="#6-各api兼容性" class="headerlink" title="6.各api兼容性"></a>6.各api兼容性</h2><p>和service worker配套使用的api支持情况和service worker本身不一致，支持情况如下</p>
<h3 id="6-1-serviceWorker"><a href="#6-1-serviceWorker" class="headerlink" title="6.1 serviceWorker"></a>6.1 serviceWorker</h3><p><img src="/blog/img/20200503/image-20200528190447870.png" srcset="/blog/img/loading.gif" alt="image-20200528190447870">    </p>
<h3 id="6-2-caches"><a href="#6-2-caches" class="headerlink" title="6.2 caches"></a>6.2 caches</h3><p><a href="https://developer.mozilla.org/en-US/docs/Web/API/CacheStorage" target="_blank" rel="noopener">caches对象mdn介绍</a>。有match、 has、open、delete和keys四个函数，都是返回promise。兼容如下图</p>
<p><img src="/blog/img/20200503/image-20200527134243932.png" srcset="/blog/img/loading.gif" alt="image-20200527134243932"></p>
<h3 id="6-3-fetch"><a href="#6-3-fetch" class="headerlink" title="6.3 fetch"></a>6.3 fetch</h3><p><img src="/blog/img/20200503/image-20200527144635398.png" srcset="/blog/img/loading.gif" alt="image-20200527144635398"></p>
<h3 id="6-4-结论"><a href="#6-4-结论" class="headerlink" title="6.4 结论"></a>6.4 结论</h3><p>直接service worker的就一定支持cache和fetch(2，3项功能不行)，所以用如下代码即可：</p>
<pre><code class="hljs scilab"><span class="hljs-keyword">if</span> (<span class="hljs-string">'serviceWorker'</span> in navigator) &#123;
      console.<span class="hljs-built_in">log</span>(<span class="hljs-string">'支持service worker'</span>)
      navigator.serviceWorker.register(<span class="hljs-string">'&lt;%= process.env.VUE_APP_PWA_PATH %&gt;service-worker.js'</span>)
      .<span class="hljs-keyword">then</span>(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(reg)</span> &#123;</span>
        <span class="hljs-comment">// registration worked</span>
        console.<span class="hljs-built_in">log</span>(<span class="hljs-string">'Registration succeeded. Scope is '</span> + reg.scope);
      &#125;)
      .<span class="hljs-keyword">catch</span>(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(error)</span> &#123;</span>
        <span class="hljs-comment">// registration failed</span>
        console.<span class="hljs-built_in">log</span>(<span class="hljs-string">'Registration failed with '</span> + <span class="hljs-built_in">error</span>);
      &#125;);
    &#125; <span class="hljs-keyword">else</span> &#123;
      console.<span class="hljs-built_in">log</span>(<span class="hljs-string">'不支持service worker'</span>)
    &#125;</code></pre>

<h2 id="7-手机实测"><a href="#7-手机实测" class="headerlink" title="7.手机实测"></a>7.手机实测</h2><p>安卓app（x5）： 支持navigator.serviceWorker属性, 但是install钩子不执行，原因未明</p>
<p>安卓app：<img src="/blog/img/20200503/image-20200601105517390.png" srcset="/blog/img/loading.gif" alt="image-20200601105517390"></p>
<p>安卓自带浏览器： 正常。由于连手机无法正常查看浏览器相关cache。接口时间对比如下（http和https）：</p>
<p><img src="/blog/img/20200503/image-20200531133132867.png" srcset="/blog/img/loading.gif" alt="image-20200531133132867"></p>
<p><img src="/blog/img/20200503/image-20200531133427630.png" srcset="/blog/img/loading.gif" alt="image-20200531133427630"></p>
<p>Ios safari：</p>
<p><img src="/blog/img/20200503/image-20200531134344522.png" srcset="/blog/img/loading.gif" alt="image-20200531134333522"><br><img src="/blog/img/20200503/image-20200531134333522.png" srcset="/blog/img/loading.gif" alt="image-20200531134333522"></p>
<p>iOS app：不支持。</p>

            </article>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                
              </div>
              
                <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" target="_blank" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！</p>
              
              
                <div class="post-prevnext row">
                  <div class="post-prev col-6">
                    
                    
                      <a href="/blog/2020/07/17/20200717/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Google V8引擎学习笔记（一）</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </div>
                  <div class="post-next col-6">
                    
                    
                      <a href="/blog/2019/11/19/20191119/">
                        <span class="hidden-mobile">不使用 brew，如何安装 zsh ？</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </div>
                </div>
              
            </div>

            
          </div>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div id="tocbot"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    
  </main>

  
    <a id="scroll-top-button" href="#" role="button">
      <i class="iconfont icon-arrowup" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  

  

  <footer class="mt-5">
  <div class="text-center py-3">
    <div>
      <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a>
      <i class="iconfont icon-love"></i>
      <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener">
        <span>Fluid</span></a>
    </div>
    

    

    
  </div>
</footer>

<!-- SCRIPTS -->
<script  src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js" ></script>
<script  src="/blog/js/debouncer.js" ></script>
<script  src="/blog/js/main.js" ></script>

<!-- Plugins -->


  
    <script  src="/blog/js/lazyload.js" ></script>
  



  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>
  <script  src="/blog/js/clipboard-use.js" ></script>







  <script  src="https://cdn.staticfile.org/tocbot/4.11.1/tocbot.min.js" ></script>
  <script>
    $(document).ready(function () {
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;

      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: 'article.markdown-body',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        collapseDepth: 0,
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc').css('visibility', 'visible');
      }
    });
  </script>





  <script  src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js" ></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script  src="/blog/js/local-search.js" ></script>
  <script>
    var path = "/blog/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      searchFunc(path, 'local-search-input', 'local-search-result');
      this.onclick = null
    }
  </script>



  <script  src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />

  <script>
    $('#post img:not(.no-zoom img, img[no-zoom]), img[zoom]').each(
      function () {
        var element = document.createElement('a');
        $(element).attr('data-fancybox', 'images');
        $(element).attr('href', $(this).attr('src'));
        $(this).wrap(element);
      }
    );
  </script>




















</body>
</html>
